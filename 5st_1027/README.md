
# 5주차: Node.js 기초

## Node.js 소개 및 설치

Node.js 로고

### Node.js란?

Node.js는 "Chrome V8 JavaScript 엔진으로 빌드된 JavaScript 런타임"입니다. 이는 JavaScript를 서버 사이드에서 실행할 수 있게 해주는 플랫폼입니다. 과거에는 JavaScript가 주로 웹 브라우저에서만 동작하는 프론트엔드 언어로 사용되었지만, Node.js의 등장으로 백엔드 개발에도 사용할 수 있게 되었습니다.

### Node.js의 동작 방식

Node.js는 비동기 이벤트 기반 아키텍처를 사용합니다. 이를 설명하기 위해 티켓 예매 시나리오를 살펴보겠습니다:

**일반 서버의 경우:**
1. 첫 번째 손님이 티켓 1장을 요청하고 받습니다.
2. 두 번째 손님은 첫 번째 손님의 처리가 끝날 때까지 기다린 후 티켓을 요청합니다.
3. 세 번째 손님이 200장을 요청하면, 서버는 이 요청을 처리하는 동안 다른 모든 요청을 대기시킵니다.

**Node.js 서버의 경우:**
- 모든 요청을 동시에 받아들이고, 처리 속도가 빠른 순서대로 결과를 반환합니다.
- 이는 Node.js의 **Non-blocking I/O** 특성 때문입니다.

### Node.js의 강점

1. **실시간 애플리케이션에 적합:** SNS, 채팅 서비스 등 많은 요청을 처리해야 하는 애플리케이션에 적합합니다.
2. **빠른 개발:** 코드가 간결하여 빠른 개발과 피봇팅이 가능합니다.
3. **대규모 서비스에서의 검증:** 에어비엔비, 넷플릭스, 페이팔 등 대규모 서비스에서 사용되어 안정성과 보안성이 검증되었습니다.

### Node.js의 단점

- CPU 집약적인 작업에는 적합하지 않습니다. 이미지/비디오 처리, 대규모 데이터 처리 등에는 다른 언어나 플랫폼이 더 적합할 수 있습니다.

### 설치 방법

1. [Node.js 공식 웹사이트](https://nodejs.org/)에서 설치 파일을 다운로드합니다.
2. 설치 파일을 실행하고 안내에 따라 설치를 진행합니다.
3. 설치가 완료되면 명령 프롬프트(cmd)에서 다음 명령어로 설치를 확인할 수 있습니다:

```bash
node --version
npm --version
```

설치 확인


## NPM (Node Package Manager)

NPM은 Node.js의 패키지 관리 도구입니다. JavaScript 라이브러리를 쉽게 설치하고 관리할 수 있게 해줍니다.

### NPM이란?

NPM은 Node.js의 기본 패키지 관리자로, 세계 최대의 소프트웨어 레지스트리입니다. JavaScript 개발자들이 코드 패키지를 공유하고 재사용할 수 있게 해줍니다.

### NPM의 주요 구성 요소

1. **웹사이트**: 패키지 검색, 프로필 설정, 기타 NPM 관련 기능을 제공합니다.
2. **명령줄 인터페이스(CLI)**: 터미널에서 NPM을 사용할 수 있게 해주는 도구입니다.
3. **레지스트리**: JavaScript 소프트웨어와 메타 정보를 포함하는 대규모 공개 데이터베이스입니다.

### NPM의 주요 기능

- 코드 패키지를 앱에 적용하거나 통합할 수 있습니다.
- 독립 실행형 도구를 다운로드하여 즉시 사용할 수 있습니다.
- npx를 사용하여 패키지를 설치하지 않고 실행할 수 있습니다.
- 코드를 다른 NPM 사용자와 공유할 수 있습니다.
- 특정 개발자들에게 코드 접근을 제한할 수 있습니다.
- 조직을 만들어 패키지 유지보수, 코딩, 개발자들을 관리할 수 있습니다.

### 패키지 설치 방법

```bash
# 일반 설치
npm install <package>

# 전역 설치
npm install -g <package>

# 특정 버전 설치
npm install <package-name>@<version>
```

### 주요 NPM 명령어

1. `npm init`: 새 NPM 패키지를 초기화합니다.
2. `npm install`: `package.json`에 명시된 모든 의존성을 설치합니다.
3. `npm uninstall <package-name>`: 특정 패키지를 제거합니다.
4. `npm update`: 모든 패키지를 최신 버전으로 업데이트합니다.
5. `npm outdated`: 오래된 패키지 목록을 표시합니다.
6. `npm run <script-name>`: `package.json`에 정의된 스크립트를 실행합니다.

### package.json 파일

`package.json` 파일은 NPM 프로젝트의 핵심으로, 프로젝트의 메타데이터, 의존성, 스크립트 등 중요한 정보를 포함합니다.

### 의존성 관리

NPM은 시맨틱 버저닝(Semantic Versioning)을 사용하여 패키지 버전을 관리합니다. 이를 통해 개발자들은 패키지를 자동으로 업데이트하면서도 원치 않는 주요 변경사항을 피할 수 있습니다.

## 모듈 시스템과 이벤트 루프

## Node.js 모듈 시스템: 레고 블록으로 프로그램 만들기

### 기본 개념

1. **모듈**: 각각의 레고 블록
   - 특정 기능을 가진 코드의 묶음입니다.
   - 독립적으로 존재하며, 다른 블록과 조합할 수 있습니다.

2. **require 함수**: 레고 블록 가져오기
   - 다른 모듈(레고 블록)을 현재 파일에 가져옵니다.
   - `const myBlock = require('./myBlock');`

3. **module.exports**: 레고 블록의 연결 부분 만들기
   - 모듈에서 외부로 공개할 부분을 정의합니다.
   - 다른 파일에서 이 모듈을 사용할 때 접근할 수 있는 부분입니다.

### 작동 방식

1. **모듈 만들기 (레고 블록 제작)**
   ```javascript
   // greetingBlock.js
   function sayHello(name) {
     console.log(`안녕하세요, ${name}님!`);
   }

   module.exports = sayHello;
   ```
   - 이것은 "인사하기" 기능을 가진 레고 블록을 만든 것과 같습니다.

2. **모듈 사용하기 (레고 블록 조립)**
   ```javascript
   // main.js
   const greet = require('./greetingBlock');

   greet('철수'); // "안녕하세요, 철수님!" 출력
   ```
   - 만든 레고 블록을 가져와서 사용하는 것과 같습니다.

### 모듈의 장점

1. **코드 재사용**: 한 번 만든 레고 블록을 여러 곳에서 사용할 수 있습니다.
2. **코드 구조화**: 큰 프로그램을 작은 부품들로 나눠 관리할 수 있습니다.
3. **네임스페이스 관리**: 각 모듈은 독립적인 공간을 가져 이름 충돌을 방지합니다.

### 다양한 모듈 내보내기 방식

1. **단일 기능 내보내기**
   ```javascript
   module.exports = function() { /* ... */ };
   ```

2. **여러 기능 내보내기**
   ```javascript
   module.exports = {
     function1: function() { /* ... */ },
     function2: function() { /* ... */ }
   };
   ```

3. **객체에 속성 추가하기**
   ```javascript
   exports.function1 = function() { /* ... */ };
   exports.function2 = function() { /* ... */ };
   ```

Node.js의 모듈 시스템을 사용하면, 큰 프로그램을 작은 부품(모듈)들로 나누어 개발할 수 있습니다. 이는 마치 다양한 레고 블록들을 조합하여 복잡한 구조물을 만드는 것과 같습니다. 각 모듈은 독립적으로 개발, 테스트, 재사용될 수 있어 효율적인 프로그램 개발이 가능합니다.

### 이벤트 루프


## Node.js의 이벤트 루프: 비동기 작업의 관리자

Node.js의 이벤트 루프는 비동기 작업을 효율적으로 관리하는 시스템입니다. 이를 놀이공원의 여러 놀이기구를 관리하는 것에 비유해 설명해 보겠습니다.

### 1. 타이머 단계 (Timers)
- **비유**: 시간제 놀이기구
- **역할**: `setTimeout`과 `setInterval`로 예약된 콜백을 실행합니다.
- **작동**: 정해진 시간이 되면 해당 콜백을 실행합니다.
- **예시**: "30분 후에 알림 울리기"와 같은 작업

### 2. 보류 중인 콜백 단계 (Pending Callbacks)
- **비유**: 대기 중인 손님들
- **역할**: 이전 루프에서 연기된 I/O 콜백을 실행합니다.
- **작동**: 시스템 작업(예: TCP 오류 처리)과 관련된 콜백을 처리합니다.
- **예시**: 네트워크 오류 처리와 같은 작업

### 3. 유휴, 준비 단계 (Idle, Prepare)
- **비유**: 놀이공원 내부 정비
- **역할**: Node.js 내부에서만 사용됩니다.
- **작동**: 이벤트 루프의 다음 반복을 준비합니다.

### 4. 폴링 단계 (Poll)
- **비유**: 새로운 손님 맞이하기
- **역할**: 새로운 I/O 이벤트를 처리하고 관련 콜백을 실행합니다.
- **작동**: 
  1. 타이머가 만료되었는지 확인합니다.
  2. 보류 중인 I/O 콜백을 실행합니다.
  3. 필요하다면 잠시 대기하며 새 이벤트를 기다립니다.
- **예시**: 파일 읽기/쓰기, 네트워크 요청 처리

### 5. 체크 단계 (Check)
- **비유**: 빠른 패스트트랙
- **역할**: `setImmediate()` 콜백을 실행합니다.
- **작동**: 폴링 단계 직후에 실행되어야 할 콜백을 처리합니다.
- **예시**: 긴급하게 처리해야 할 작업

### 6. 종료 콜백 단계 (Close Callbacks)
- **비유**: 놀이기구 정리 및 마감
- **역할**: 일부 종료 콜백을 실행합니다.
- **작동**: 소켓이나 핸들을 닫는 등의 정리 작업을 수행합니다.
- **예시**: 서버 연결 종료, 파일 스트림 닫기

### 이벤트 루프의 전체 흐름

1. 이벤트 루프는 위의 단계들을 순차적으로 반복합니다.
2. 각 단계에는 실행할 콜백의 FIFO(First-In-First-Out) 큐가 있습니다.
3. 한 단계가 시작되면, 해당 단계의 작업을 모두 처리하거나 시스템 한도에 도달할 때까지 실행합니다.
4. 그 후 다음 단계로 이동합니다.

이 구조를 통해 Node.js는 단일 스레드로 동작하면서도 많은 비동기 작업을 효율적으로 처리할 수 있습니다. 각 단계는 특정 유형의 작업을 담당하며, 이를 통해 I/O 작업, 타이머, 즉시 실행해야 할 작업 등을 균형있게 처리할 수 있습니다.

## Express 프레임워크 소개 및 설치

Express는 Node.js를 위한 빠르고 간편한 웹 애플리케이션 프레임워크입니다.

### 주요 특징

- **미들웨어:** 요청-응답 주기를 관리하는 함수들
- **라우팅:** URL에 따른 요청 처리 관리
- **템플릿 엔진 지원:** 동적 콘텐츠 생성 지원 (예: Pug, EJS)
- **정적 파일 제공:** CSS, 이미지 등의 정적 파일 서비스 용이

### 설치 방법

1. 프로젝트 폴더 생성 및 이동
2. `npm init` 실행하여 `package.json` 파일 생성
3. Express 설치:

```bash
npm install express --save
```

4. `app.js` 파일 생성 및 기본 코드 작성:

```javascript
const express = require('express');
const app = express();
const port = 3000;

app.get('/', (req, res) => {
  res.send('Hello World!');
});

app.listen(port, () => {
  console.log(`Example app listening on port ${port}`);
});
```

5. `package.json`에 start 스크립트 추가:

```json
"scripts": {
  "start": "node app.js"
}
```

6. 애플리케이션 실행:

```bash
npm start
```

## 실습: 간단한 Node.js/Express 서버 작성

이 부분은 이미 위의 Express 설치 및 기본 서버 작성 과정에서 다루었습니다. 학습자들은 이 기본 서버를 확장하여 추가적인 라우트를 만들거나, 미들웨어를 사용해볼 수 있습니다.

예를 들어, 새로운 라우트 추가:

```javascript
app.get('/about', (req, res) => {
  res.send('About Us Page');
});
```

또는 정적 파일 제공을 위한 미들웨어 사용:

```javascript
app.use(express.static('public'));
```

이렇게 하면 `public` 폴더 내의 파일들을 정적 파일로 제공할 수 있습니다.

이 문서는 Node.js와 Express의 기본 개념을 소개하고 있습니다. 실제 학습 과정에서는 각 개념에 대해 더 자세한 설명과 실습이 필요할 것입니다.
